<!doctype html>
<html lang="pl">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <!-- Fonrt Awsome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <title>Animacja</title>
    <style>
    </style>
</head>
<body>


<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
 
   
<div class="container">

    <div class="col-lg-2">
        <a class="navbar-brand" href="home.html" style="margin: auto;"><i class="fas fa-home"></i>Home</a>
    </div>

    <div class="col-lg-5">
    <ul class="navbar-nav">
        <li class="nav-item" style="margin-left: 30%;">
            <a class="nav-link" href="index.html">Wyszukiwarka</a>
        </li>
    </ul>
    </div>

    <div class="col-lg-2">
        <a>#GraphicDesignIsMyPassion</a>
    </div>
</div>
</nav> 

  <div class="card-footer">
    <div class="card-footer">
        <div id="divhah">
            <p id="p">Wyszukiwarka miast Wyszukiwarka miast Wyszukiwarka miast Wyszukiwarka miast Wyszukiwarka miast Wyszukiwarka miast Wyszukiwarka miast</p>
          </div>
          <div style="text-align: center;">
            <p style="margin-top: 3px;">Aplikacja pozwala na znalezienie miasta w danej odległości od innego miasta.</p>
          </div>
    </div>
    <div class="card-footer">
      <div style="text-align: center;">
        <select name="select1" id="select2"></select>
        <input type="text" name="input1" id="input2" placeholder="wpisz odległość(liczbę)">
        <button id="buttonik" class="btn btn-warning btn-sm" style="margin-top: -0.4%;">Click</button>
        <div id="dane"></div>
      </div>
        <script>
            function loadJSON(callback) {
                var xobj = new XMLHttpRequest();
                xobj.overrideMimeType("application/json");
                xobj.open('GET', 'citiesPl.json', true);
                xobj.onreadystatechange = function () {
                    if (xobj.readyState == 4 && xobj.status == "200") {
                        callback(xobj.responseText);
                    }
                };
                xobj.send(null);
            }

            loadJSON(function (response) {
                var actual_JSON = JSON.parse(response);
                // actual_JSON.sort(function(a,b){
                //   return a.name > b.name;
                // });
                for (let i = 0; i < actual_JSON.length; i++) {
                    el = document.createElement('option')
                    el.innerHTML = actual_JSON[i].name
                    el.value = i
                    document.getElementById("select2").appendChild(el)
                }
                return actual_JSON
            })
            const buttonik = document.getElementById("buttonik").addEventListener('click', () => {
                document.getElementById("dane").innerHTML = ""
                const promien = parseInt(document.getElementById("input2").value)
                const miasto = document.getElementById("select2").value
                console.log(miasto, promien)
                loadJSON(function (response) {
                    var actual_JSON = JSON.parse(response)
                    console.log(actual_JSON)
                    let tablica = []
                    let odleglosci = []
                    for (let j = 0; j < actual_JSON.length; j++) {
                        if (actual_JSON[j].Id != actual_JSON[miasto]) {
                            let odleglosc = Math.sqrt((actual_JSON[j].lat - actual_JSON[miasto].lat) ** 2 + (actual_JSON[j].lng - actual_JSON[miasto].lng) ** 2) * 73
                            if (odleglosc <= promien && odleglosc != 0) {
                                tablica.push(actual_JSON[j])
                                odleglosci.push(odleglosc)
                            }
                        }
                    }
                    tablica.shift()
                    tablica.sort(function (a, b) {
                        var sthA = a.name.toUpperCase();
                        var sthB = b.name.toUpperCase();
                        if (sthA < sthB) {
                            return -1;
                        }
                        if (sthA > sthB) {
                            return 1;
                        }
                    })

                    document.getElementById('dane').innerHTML += "Suma miast: " + tablica.length + "<br>"
                    for (let x = 0; x < tablica.length; x++) {
                        document.getElementById("dane").innerHTML += tablica[x].name +': '+ (Math.round(odleglosci[x+1]*100)/100)+ ' km ' + "<br>" 
                        console.log(tablica[x].name, odleglosci[x+1])
                    }
                })

            })

        </script>

        <!-- <div id="div3"></div> -->
    </div>
    <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
  </div>

  <footer class="site-footer">
    <div class="container">
      <div class="row">
        <div class="col-sm-12 col-md-6">
          <h6>O stronce</h6>
          <!-- <p class="text-justify">Stronka została zrobiona w klasie pierwszej na zajeciach z HTML-a.</p> -->
          <p class="text-justify">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
        </div>

        <div class="col-xs-6 col-md-3">
          <h6>Linki</h6>
          <ul class="footer-links">
            <li><a href="">Href</a></li>
            <li><a href="">Href</a></li>
          </ul>
        </div>

        <div class="col-xs-6 col-md-3">
          <h6>Kontakty</h6>
          <ul class="footer-links">
            <!-- <li><a href="https://www.facebook.com/mateusz.janicki.92798">Mateusz Janicki</a></li>
            <li><a href="https://www.google.com/search?ei=EL3MX6mMIof1qwHV6IvIBA&q=S%C5%82owackiego+18%2C+My%C5%9Blenice&oq=myslenice+slowackiego+18&gs_lcp=CgZwc3ktYWIQARgAMgIIJlCoZVioZWC-cmgAcAB4AIAB5wGIAc8CkgEFMC4xLjGYAQCgAQGqAQdnd3Mtd2l6wAEB&sclient=psy-ab">ul.Slowackiego 18, 32-400 Myślenice</a></li>
            <li><a href="#"><i class="fas fa-phone"></i>502 750 256</a></li>
            <li><a href="#"><i class="fas fa-envelope"></i>mj4nicki@gmail.com</a></li> -->
            <li><a href="">Mateusz Janicki</a></li>
            <li><a href="">Ulica Numer, Kod Pocztowy Miejscowość</a></li>
            <li><a href=""><i class="fas fa-phone"></i> Nr telefonu</a></li>
            <li><a href=""><i class="fas fa-envelope"></i> Adres e-mail</a></li>
          </ul>
        </div>
      </div>
      <hr>
    </div>
    <div class="container">
      <div class="row">
        <div class="col-md-8 col-sm-6 col-xs-12">
          <p class="copyright-text">Copyright &copy; 2021 All Rights Reserved by 
       <!-- <a href="https://www.facebook.com/mateusz.janicki.92798">Mateusz Janicki</a>. -->
       <a href="">Mateusz Janicki</a>.
          </p>
        </div>
      </div>
    </div>
  </footer>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
</body>
</html>